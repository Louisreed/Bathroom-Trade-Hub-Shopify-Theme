{%- comment -%}
  HubPRO Form Section - Raw HTML with CSS Overrides
  Allows insertion of third-party generated HTML with comprehensive styling controls
{%- endcomment -%}

<style>
  #shopify-section-{{ section.id }} {
    --section-padding-top: {{ section.settings.padding_top }}px;
    --section-padding-bottom: {{ section.settings.padding_bottom }}px;
  }

  .hubpro-form-wrapper {
    padding-top: var(--section-padding-top);
    padding-bottom: var(--section-padding-bottom);
  }

  .hubpro-form-container {
    max-width: {{ section.settings.form_max_width }}px;
    margin: 0 auto;
    padding: {{ section.settings.form_padding }}px;
    {% if section.settings.form_background != 'rgba(0,0,0,0)' %}
      background-color: {{ section.settings.form_background }};
    {% endif %}
    {% if section.settings.form_border_radius > 0 %}
      border-radius: {{ section.settings.form_border_radius }}px;
    {% endif %}
    {% if section.settings.form_shadow %}
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    {% endif %}
  }

  /* Form container overrides */
  #shopify-section-{{ section.id }} .aaamembership_form {
    margin: 0;
    padding: 0;
  }

  /* Header styling overrides */
  #shopify-section-{{ section.id }} .aaamembership_form .header {
    color: {{ section.settings.header_color }} !important;
    margin-bottom: {{ section.settings.header_spacing }}px !important;
  }

  #shopify-section-{{ section.id }} .aaamembership_form h1.header {
    font-size: {{ section.settings.h1_font_size }}px !important;
    font-weight: {{ section.settings.h1_font_weight }} !important;
  }

  #shopify-section-{{ section.id }} .aaamembership_form h3.header {
    font-size: {{ section.settings.h3_font_size }}px !important;
    font-weight: {{ section.settings.h3_font_weight }} !important;
  }

  /* Divider styling */
  #shopify-section-{{ section.id }} .aaamembership_form .aaadivider {
    border-color: {{ section.settings.divider_color }} !important;
    margin: {{ section.settings.divider_spacing }}px 0 !important;
  }

  /* Label styling overrides */
  #shopify-section-{{ section.id }} .aaamembership_form label {
    color: {{ section.settings.label_color }} !important;
    font-size: {{ section.settings.label_font_size }}px !important;
    font-weight: {{ section.settings.label_font_weight }} !important;
    margin-bottom: 8px !important;
    display: block !important;
  }

  /* Required asterisk styling */
  #shopify-section-{{ section.id }} .aaamembership_form .required {
    color: {{ section.settings.required_color }} !important;
  }

  /* Form field styling overrides */
  #shopify-section-{{ section.id }} .aaamembership_form input[type="text"],
  #shopify-section-{{ section.id }} .aaamembership_form input[type="search"],
  #shopify-section-{{ section.id }} .aaamembership_form input[type="password"],
  #shopify-section-{{ section.id }} .aaamembership_form input[type="email"],
  #shopify-section-{{ section.id }} .aaamembership_form input[type="file"],
  #shopify-section-{{ section.id }} .aaamembership_form input[type="number"],
  #shopify-section-{{ section.id }} .aaamembership_form input[type="tel"],
  #shopify-section-{{ section.id }} .aaamembership_form textarea,
  #shopify-section-{{ section.id }} .aaamembership_form select {
    width: 100% !important;
    margin: 0 !important;
    border: {{ section.settings.field_border_width }}px solid {{ section.settings.field_border_color }} !important;
    border-radius: {{ section.settings.field_border_radius }}px !important;
    padding: {{ section.settings.field_padding }}px !important;
    font-size: {{ section.settings.field_font_size }}px !important;
    background-color: {{ section.settings.field_background }} !important;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
  }

  /* Field focus states */
  #shopify-section-{{ section.id }} .aaamembership_form input:focus,
  #shopify-section-{{ section.id }} .aaamembership_form textarea:focus,
  #shopify-section-{{ section.id }} .aaamembership_form select:focus {
    border-color: {{ section.settings.field_focus_color }} !important;
    {% if section.settings.field_focus_glow %}
      box-shadow: 0 0 0 2px rgba({{ section.settings.field_focus_color | color_extract: 'red' }}, {{ section.settings.field_focus_color | color_extract: 'green' }}, {{ section.settings.field_focus_color | color_extract: 'blue' }}, 0.2) !important;
    {% endif %}
    outline: none !important;
  }

  /* Form group spacing */
  #shopify-section-{{ section.id }} .aaamembership_form .form-group {
    margin-bottom: {{ section.settings.field_spacing }}px !important;
  }

  /* Button styling overrides */
  #shopify-section-{{ section.id }} .aaamembership_form .membership-submit button,
  #shopify-section-{{ section.id }} .aaamembership_form .button-input {
    background-color: {{ section.settings.button_background }} !important;
    color: {{ section.settings.button_color }} !important;
    font-size: {{ section.settings.button_font_size }}px !important;
    font-weight: {{ section.settings.button_font_weight }} !important;
    padding: {{ section.settings.button_padding_vertical }}px {{ section.settings.button_padding_horizontal }}px !important;
    border-radius: {{ section.settings.button_border_radius }}px !important;
    border: {{ section.settings.button_border_width }}px solid {{ section.settings.button_border_color }} !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    {% if section.settings.button_full_width %}
      width: 100% !important;
    {% endif %}
    {% if section.settings.button_text_transform != 'none' %}
      text-transform: {{ section.settings.button_text_transform }} !important;
    {% endif %}
  }

  /* Button hover states */
  #shopify-section-{{ section.id }} .aaamembership_form .membership-submit button:hover,
  #shopify-section-{{ section.id }} .aaamembership_form .button-input:hover {
    background-color: {{ section.settings.button_hover_background }} !important;
    color: {{ section.settings.button_hover_color }} !important;
    {% if section.settings.button_hover_transform %}
      transform: translateY(-1px);
    {% endif %}
  }

  /* Checkbox styling */
  #shopify-section-{{ section.id }} .aaamembership_form .checkbox {
    width: auto !important;
    margin-right: 8px !important;
  }

  /* Phone number country code field */
  #shopify-section-{{ section.id }} .aaamembership_form .aaa-customer-phone-number-country {
    width: 49% !important;
    float: left !important;
    margin-left: 1% !important;
    margin-right: 1% !important;
  }

  /* Responsive adjustments */
  @media screen and (max-width: 749px) {
    .hubpro-form-container {
      padding: calc({{ section.settings.form_padding }}px * 0.75);
      margin: 0 16px;
    }

    #shopify-section-{{ section.id }} .aaamembership_form input,
    #shopify-section-{{ section.id }} .aaamembership_form textarea,
    #shopify-section-{{ section.id }} .aaamembership_form select {
      font-size: calc({{ section.settings.field_font_size }}px * 0.9) !important;
    }
  }
</style>

<div class="hubpro-form-wrapper color-{{ section.settings.color_scheme }}">
  <div class="page-width">
    {% if section.settings.section_heading != blank %}
      <div class="section-header text-center">
        <h2 class="section-heading">{{ section.settings.section_heading }}</h2>
        {% if section.settings.section_subheading != blank %}
          <p class="section-subheading">{{ section.settings.section_subheading }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="hubpro-form-container">
      {% if section.settings.raw_form_html != blank %}
        {{ section.settings.raw_form_html }}
      {% else %}
        <div style="padding: 40px; text-align: center; border: 2px dashed #ccc; color: #999; border-radius: 8px;">
          <h3>HubPRO Form</h3>
          <p>Please paste your third-party form HTML in the "Raw Form HTML" setting to display the form here.</p>
          <p><small>The form will render exactly as provided with your custom styling applied.</small></p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Load the membership script if form is present -->
{% if section.settings.raw_form_html != blank %}
  <script>
    function loadHubProMembershipScript() {
      var shopDomain = '{{ section.settings.script_shop_domain | default: "ab97df-6.myshopify.com" }}';
      var url =
        'https://shopifycdn.aaawebstore.com/membership/appfiles/aaa_membership_script_min_v3.js?shop=' + shopDomain;
      var jsFound = 0;
      var scripts = document.getElementsByTagName('script');

      for (var i = scripts.length; i--; ) {
        if (scripts[i].src == url) {
          jsFound = 1;
          break;
        }
      }

      if (!jsFound) {
        var headTag = document.getElementsByTagName('head')[0];
        var scriptTag = document.createElement('script');
        scriptTag.type = 'text/javascript';
        scriptTag.src = url;
        scriptTag.onload = function () {
          console.log('HubPRO membership script loaded successfully');
        };
        scriptTag.onerror = function () {
          console.error('Failed to load HubPRO membership script');
        };
        headTag.appendChild(scriptTag);
      }
    }

    // Load script when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadHubProMembershipScript);
    } else {
      loadHubProMembershipScript();
    }
  </script>
{% endif %}

{% schema %}
{
  "name": "HubPRO Form",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Form Content"
    },
    {
      "type": "textarea",
      "id": "raw_form_html",
      "label": "Raw Form HTML",
      "info": "Paste the complete HTML code from your third-party form here. All styling options below will override the form's appearance.",
      "placeholder": "Paste your form HTML code here..."
    },
    {
      "type": "text",
      "id": "script_shop_domain",
      "label": "Script Shop Domain",
      "default": "ab97df-6.myshopify.com",
      "info": "The shop domain for loading the membership script (e.g., your-shop.myshopify.com)"
    },
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "text",
      "id": "section_heading",
      "label": "Section Heading"
    },
    {
      "type": "text",
      "id": "section_subheading",
      "label": "Section Subheading"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        },
        {
          "value": "background-1",
          "label": "Background 1"
        },
        {
          "value": "background-2",
          "label": "Background 2"
        },
        {
          "value": "inverse",
          "label": "Inverse"
        }
      ],
      "default": "background-1",
      "label": "Color Scheme"
    },
    {
      "type": "header",
      "content": "Form Container Styling"
    },
    {
      "type": "color",
      "id": "form_background",
      "label": "Form Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "form_max_width",
      "min": 400,
      "max": 1000,
      "step": 50,
      "unit": "px",
      "label": "Form Max Width",
      "default": 600
    },
    {
      "type": "range",
      "id": "form_padding",
      "min": 16,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Form Padding",
      "default": 32
    },
    {
      "type": "range",
      "id": "form_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Form Border Radius",
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "form_shadow",
      "label": "Form Drop Shadow",
      "default": true
    },
    {
      "type": "header",
      "content": "Headers (H1 & H3) Styling"
    },
    {
      "type": "color",
      "id": "header_color",
      "label": "Header Text Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "h1_font_size",
      "min": 18,
      "max": 36,
      "step": 1,
      "unit": "px",
      "label": "Main Header (H1) Font Size",
      "default": 24
    },
    {
      "type": "range",
      "id": "h3_font_size",
      "min": 14,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Sub Header (H3) Font Size",
      "default": 18
    },
    {
      "type": "select",
      "id": "h1_font_weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "700",
      "label": "Main Header Font Weight"
    },
    {
      "type": "select",
      "id": "h3_font_weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600",
      "label": "Sub Header Font Weight"
    },
    {
      "type": "range",
      "id": "header_spacing",
      "min": 8,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Header Bottom Spacing",
      "default": 16
    },
    {
      "type": "header",
      "content": "Divider Styling"
    },
    {
      "type": "color",
      "id": "divider_color",
      "label": "Divider Color",
      "default": "#cccccc"
    },
    {
      "type": "range",
      "id": "divider_spacing",
      "min": 8,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Divider Spacing",
      "default": 16
    },
    {
      "type": "header",
      "content": "Label Styling"
    },
    {
      "type": "color",
      "id": "label_color",
      "label": "Label Text Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "label_font_size",
      "min": 12,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Label Font Size",
      "default": 14
    },
    {
      "type": "select",
      "id": "label_font_weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "500",
      "label": "Label Font Weight"
    },
    {
      "type": "color",
      "id": "required_color",
      "label": "Required Asterisk (*) Color",
      "default": "#ff0000"
    },
    {
      "type": "header",
      "content": "Form Fields Styling"
    },
    {
      "type": "color",
      "id": "field_background",
      "label": "Field Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "field_border_color",
      "label": "Field Border Color",
      "default": "#cccccc"
    },
    {
      "type": "range",
      "id": "field_border_width",
      "min": 1,
      "max": 3,
      "step": 1,
      "unit": "px",
      "label": "Field Border Width",
      "default": 1
    },
    {
      "type": "range",
      "id": "field_border_radius",
      "min": 0,
      "max": 12,
      "step": 1,
      "unit": "px",
      "label": "Field Border Radius",
      "default": 4
    },
    {
      "type": "range",
      "id": "field_padding",
      "min": 8,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Field Padding",
      "default": 12
    },
    {
      "type": "range",
      "id": "field_font_size",
      "min": 12,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Field Font Size",
      "default": 14
    },
    {
      "type": "range",
      "id": "field_spacing",
      "min": 12,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Space Between Fields",
      "default": 20
    },
    {
      "type": "color",
      "id": "field_focus_color",
      "label": "Field Focus Border Color",
      "default": "#0066cc"
    },
    {
      "type": "checkbox",
      "id": "field_focus_glow",
      "label": "Field Focus Glow Effect",
      "default": true
    },
    {
      "type": "header",
      "content": "Submit Button Styling"
    },
    {
      "type": "color",
      "id": "button_background",
      "label": "Button Background Color",
      "default": "#BB9F4D"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_background",
      "label": "Button Hover Background Color",
      "default": "#a08a42"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Button Hover Text Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button Font Size",
      "default": 14
    },
    {
      "type": "select",
      "id": "button_font_weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600",
      "label": "Button Font Weight"
    },
    {
      "type": "range",
      "id": "button_padding_vertical",
      "min": 8,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Button Vertical Padding",
      "default": 12
    },
    {
      "type": "range",
      "id": "button_padding_horizontal",
      "min": 16,
      "max": 48,
      "step": 4,
      "unit": "px",
      "label": "Button Horizontal Padding",
      "default": 24
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Button Border Radius",
      "default": 4
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Button Border Color",
      "default": "#BB9F4D"
    },
    {
      "type": "range",
      "id": "button_border_width",
      "min": 0,
      "max": 3,
      "step": 1,
      "unit": "px",
      "label": "Button Border Width",
      "default": 0
    },
    {
      "type": "select",
      "id": "button_text_transform",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "uppercase",
          "label": "UPPERCASE"
        },
        {
          "value": "lowercase",
          "label": "lowercase"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        }
      ],
      "default": "none",
      "label": "Button Text Transform"
    },
    {
      "type": "checkbox",
      "id": "button_full_width",
      "label": "Full Width Button",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "button_hover_transform",
      "label": "Button Hover Lift Effect",
      "default": true
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top Padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom Padding",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "HubPRO Form"
    }
  ]
}
{% endschema %}
